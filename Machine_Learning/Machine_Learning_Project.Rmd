---
title: "Machine learning project"
author: "Jagadeesh"
date: "10/10/2020"
output: 
  html_document: 
    keep_md: yes
---

##Introduction
    Using devices such as Jawbone Up, Nike FuelBand, and Fitbit it is now possible to collect a large amount of data about personal activity relatively inexpensively. These type of devices are part of the quantified self movement â€“ a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. One thing that people regularly do is quantify how much of a particular activity they do, but they rarely quantify how well they do it. In this project, your goal will be to use data from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. They were asked to perform barbell lifts correctly and incorrectly in 5 different ways. More information is available from the website here: http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har.The data for this project come from this source: http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har. If you use the document you create for this class for any purpose please cite them as they have been very generous in allowing their data to be used for this kind of assignment.
    
In this project We have taken the data from the electronic gadgets from the accelerometres ofc the devices.it was decided that the SVM model with the lowest validation error is with cost = 10 and gamma = 1.
The main result is that when the trained model is used with the test data set from the prediction evaluation, the accuracy is equal to 100%.
##Packages used
```{r}
library(ggplot2)
library(gridExtra)
#library(caret)
library(e1071)
```
it is used for graphical representation
##load and preprocess the data
This allows to select the features according to accelerometer on belt, forearm ,dumbell
```{r}
#Read data sets
bdtraining <- read.csv("pml-training.csv")
bdtest <- read.csv("pml-testing.csv")

#Select features according to accelerometers on the belt, 
#forearm, arm and dumbell and outcome feature
selectVector <- grepl("accel|classe", names(bdtraining))

#New Training data
bdtraining <- bdtraining[,selectVector]

#Investagate features with NAs
NAvector <- sapply(bdtraining, function(x){
        sum(is.na(x))
})

#Selection vector
SeleVec <- NAvector==0

#Elimanate features with NAs
bdtraining <- bdtraining[,SeleVec]


#Select adecuate variables in test data set

#Select features according to accelerometers on the belt, 
#forearm, arm and dumbell and outcome feature
selectVector <- grepl("accel", names(bdtest))

#New Training data
bdtest <- bdtest[,selectVector]

#Investagate features with NAs
NAvector <- sapply(bdtest, function(x){
        sum(is.na(x))
})

#Selection vector
SeleVec <- NAvector==0

#Elimanate features with NAs
bdtest <- bdtest[,SeleVec]

```
##Pictographial representation to get a clear picture b/w two gadgets some exploratory data analysis
```{r}
g1 <- ggplot(bdtraining, aes(x=total_accel_belt, y=total_accel_dumbbell,
                       col=classe)) +
        geom_point(alpha = 0.2, lwd = 5)+
        theme(legend.position="none") + 
        ggtitle("Total_accel_dumbell vs total_accel_belt by classe")

g2 <- ggplot(bdtraining, aes(x=total_accel_belt, y=total_accel_forearm,
                             col=classe)) +
        geom_point(alpha = 0.2, lwd = 5) + 
        ggtitle("Total_accel_forearm vs total_accel_belt by classe")

grid.arrange(g1, g2)
```
##Model Fit
The e1071 library was used to estimate a SVM Algorithm. 5-folds cross validation were applied to determine the cost and gamma parameters of the svm function producing the lowest k-fold Cross Validation error rate
```{r warning=FALSE, error=FALSE}
#Fit SVM algorithm whit Cost = 10
#and gamma 1

bdtraining$classe<-as.factor(bdtraining$classe)
set.seed(4621)
svmfit <- svm(classe ~ ., data = bdtraining,
               kernel="radial", cost = 10, gamma=1,
               scale = TRUE,
               cross = 5)

#K fold CV error = 4.122923
    100 - svmfit$tot.accuracy
```  
##Error test
When evaluating the SVM by training in the test database, bdtest, the following predictions are produced:
```{r}
bdtest
predict(svmfit,newdata = bdtest)
```
These are the predictions